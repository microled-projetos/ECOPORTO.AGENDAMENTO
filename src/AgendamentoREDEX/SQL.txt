CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CAD_RESERVA
  (
    AUTONUM               NUMBER NOT NULL ENABLE,
    RESERVA               VARCHAR2(50 BYTE) NOT NULL ENABLE,
	AUTONUM_TRANSPORTADORA NUMBER,
    QUANTIDADE_CNTR       NUMBER,
    QUANTIDADE            NUMBER,
    PESO                  NUMBER(10,2),
    VOLUMES               NUMBER,
    METRAGEM_CUBICA       NUMBER(10,2),
    AUTONUM_ARMADOR       NUMBER NOT NULL ENABLE,
    AUTONUM_NAVIO         NUMBER NOT NULL ENABLE,
    AUTONUM_EXPORTADOR    NUMBER NOT NULL ENABLE,
    AUTONUM_NVOCC         NUMBER NOT NULL ENABLE,
    AUTONUM_VIAGEM        NUMBER NOT NULL ENABLE,
    AUTONUM_PORTO_ORIGEM  NUMBER NOT NULL ENABLE,
    AUTONUM_PORTO_DESTINO NUMBER NOT NULL ENABLE,
    FLAG_LIBERADO         NUMBER(1,0),
    DT_LIBERACAO          DATE,
    USUARIO_LIBERACAO     VARCHAR2(50 BYTE),
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CNTR_CA
  (
    AUTONUM                NUMBER NOT NULL ENABLE,
    RESERVA                VARCHAR2(50 BYTE) NOT NULL ENABLE,
    AUTONUM_MOTORISTA      NUMBER NOT NULL ENABLE,
    AUTONUM_VEICULO        NUMBER NOT NULL ENABLE,
    AUTONUM_TRANSPORTADORA NUMBER NOT NULL ENABLE,
    AUTONUM_GD_RESERVA     NUMBER NOT NULL ENABLE,
    AUTONUM_BOOKING     NUMBER NOT NULL ENABLE,
    DATA_AGENDAMENTO       DATE NOT NULL ENABLE,
    STATUS                 VARCHAR2(2 BYTE) NOT NULL ENABLE,
    NUM_PROTOCOLO          NUMBER NOT NULL ENABLE,
    ANO_PROTOCOLO          NUMBER(4,0) NOT NULL ENABLE,
    ID_CONTEINER           VARCHAR2(12 BYTE) NOT NULL ENABLE,
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CNTR_NF
  (
    AUTONUM             NUMBER NOT NULL ENABLE,
    AUTONUM_AGENDAMENTO NUMBER NOT NULL ENABLE,
    DANFE               NUMBER,
    RESERVA             VARCHAR2(50 BYTE),
    NUMERO              NUMBER,
    SERIE               VARCHAR2(50 BYTE),
    EMISSOR             VARCHAR2(100 BYTE),
    EMISSAO             DATE,
    VALOR               NUMBER,
    PESO_BRUTO          NUMBER,
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CS
  (
    AUTONUM                NUMBER NOT NULL ENABLE,
    RESERVA                VARCHAR2(50 BYTE) NOT NULL ENABLE,
	AUTONUM_BOOKING			NUMBER NOT NULL ENABLE,
    AUTONUM_MOTORISTA      NUMBER NOT NULL ENABLE,
    AUTONUM_VEICULO        NUMBER NOT NULL ENABLE,
    AUTONUM_TRANSPORTADORA NUMBER NOT NULL ENABLE,
    AUTONUM_GD_RESERVA     NUMBER NOT NULL ENABLE,
    DATA_AGENDAMENTO       DATE NOT NULL ENABLE,
    STATUS                 VARCHAR2(2 BYTE) NOT NULL ENABLE,
    NUM_PROTOCOLO          NUMBER NOT NULL ENABLE,
    ANO_PROTOCOLO          NUMBER(4,0) NOT NULL ENABLE,
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CS_CA
  (
    AUTONUM                NUMBER NOT NULL ENABLE,
    RESERVA                VARCHAR2(50 BYTE) NOT NULL ENABLE,
	AUTONUM_BOOKING        NUMBER NOT NULL ENABLE,
    AUTONUM_VIAGEM		   NUMBER NOT NULL ENABLE,
	AUTONUM_MOTORISTA      NUMBER NOT NULL ENABLE,
    AUTONUM_VEICULO        NUMBER NOT NULL ENABLE,
    AUTONUM_TRANSPORTADORA NUMBER NOT NULL ENABLE,
    AUTONUM_GD_RESERVA     NUMBER NOT NULL ENABLE,
    DATA_AGENDAMENTO       DATE NOT NULL ENABLE,
    STATUS                 VARCHAR2(2 BYTE) NOT NULL ENABLE,
    NUM_PROTOCOLO          NUMBER NOT NULL ENABLE,
    ANO_PROTOCOLO          NUMBER(4,0) NOT NULL ENABLE,
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CS_CA_ITENS
  (
    AUTONUM                NUMBER NOT NULL ENABLE,
    AUTONUM_AGENDAMENTO    NUMBER NOT NULL ENABLE,
    AUTONUM_MERCADORIA     NUMBER NOT NULL ENABLE,
    QTDE                   NUMBER NOT NULL ENABLE,
    AUTONUM_TRANSPORTADORA NUMBER NOT NULL ENABLE,
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CS_CA_NF
  (
    AUTONUM             NUMBER NOT NULL ENABLE,
    AUTONUM_AGENDAMENTO NUMBER NOT NULL ENABLE,
    DANFE               NUMBER,
    NUMERO              NUMBER,
    SERIE               VARCHAR2(50 BYTE),
    EMISSOR             VARCHAR2(100 BYTE),
    EMISSAO             DATE,
    QTDE                NUMBER,
    VALOR               NUMBER,
    PESO_BRUTO          NUMBER,
    M3                  NUMBER,
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CS_ITENS
  (
    AUTONUM             NUMBER NOT NULL ENABLE,
    AUTONUM_AGENDAMENTO NUMBER NOT NULL ENABLE,
    AUTONUM_MERCADORIA  NUMBER NOT NULL ENABLE,
    QTDE                NUMBER NOT NULL ENABLE,
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_CS_NF
  (
    AUTONUM             NUMBER NOT NULL ENABLE,
    AUTONUM_AGENDAMENTO NUMBER NOT NULL ENABLE,
    RESERVA             VARCHAR2(50 BYTE) NOT NULL ENABLE,
    DANFE               VARCHAR2(44 BYTE),
    NUMERO              NUMBER,
    SERIE               VARCHAR2(50 BYTE),
    EMISSOR             VARCHAR2(100 BYTE),
    EMISSAO             DATE,
    QTDE                NUMBER,
    VALOR               NUMBER,
    PESO_BRUTO          NUMBER,
    M3                  NUMBER,
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_PERIODO_CA
  (
    CS_M3_1 NUMBER,
    CS_M3_2 NUMBER,
    CS_M3_3 NUMBER,
    CS_M3_4 NUMBER,
    CS_M3_5 NUMBER,
    CS_M3_6 NUMBER,
    CS_M3_7 NUMBER,
    CS_M3_8 NUMBER,
    CS_PE_1 NUMBER,
    CS_PE_2 NUMBER,
    CS_PE_3 NUMBER,
    CS_PE_4 NUMBER,
    CS_PE_5 NUMBER,
    CS_PE_6 NUMBER,
    CS_PE_7 NUMBER,
    CS_PE_8 NUMBER,
    CS_VO_1 NUMBER,
    CS_VO_2 NUMBER,
    CS_VO_3 NUMBER,
    CS_VO_4 NUMBER,
    CS_VO_5 NUMBER,
    CS_VO_6 NUMBER,
    CS_VO_7 NUMBER,
    CS_VO_8 NUMBER,
    CS_CA_1 NUMBER,
    CS_CA_2 NUMBER,
    CS_CA_3 NUMBER,
    CS_CA_4 NUMBER,
    CS_CA_5 NUMBER,
    CS_CA_6 NUMBER,
    CS_CA_7 NUMBER,
    CS_CA_8 NUMBER,
    CN_CA_1 NUMBER,
    CN_CA_2 NUMBER,
    CN_CA_3 NUMBER,
    CN_CA_4 NUMBER,
    CN_CA_5 NUMBER,
    CN_CA_6 NUMBER,
    CN_CA_7 NUMBER,
    CN_CA_8 NUMBER,
    FLAG_CS_M3 NUMBER(1),
    FLAG_CS_PESO NUMBER(1),
    FLAG_CS_VOLUME NUMBER(1),
    FLAG_CS_CAMINHAO NUMBER(1),
    FLAG_CN_CAMINHAO NUMBER(1)
  );
CREATE TABLE REDEX.TB_AGENDAMENTO_WEB_PERIODO_DES
  (
    CS_M3_1 NUMBER,
    CS_M3_2 NUMBER,
    CS_M3_3 NUMBER,
    CS_M3_4 NUMBER,
    CS_M3_5 NUMBER,
    CS_M3_6 NUMBER,
    CS_M3_7 NUMBER,
    CS_M3_8 NUMBER,
    CS_PE_1 NUMBER,
    CS_PE_2 NUMBER,
    CS_PE_3 NUMBER,
    CS_PE_4 NUMBER,
    CS_PE_5 NUMBER,
    CS_PE_6 NUMBER,
    CS_PE_7 NUMBER,
    CS_PE_8 NUMBER,
    CS_VO_1 NUMBER,
    CS_VO_2 NUMBER,
    CS_VO_3 NUMBER,
    CS_VO_4 NUMBER,
    CS_VO_5 NUMBER,
    CS_VO_6 NUMBER,
    CS_VO_7 NUMBER,
    CS_VO_8 NUMBER,
    CS_CA_1 NUMBER,
    CS_CA_2 NUMBER,
    CS_CA_3 NUMBER,
    CS_CA_4 NUMBER,
    CS_CA_5 NUMBER,
    CS_CA_6 NUMBER,
    CS_CA_7 NUMBER,
    CS_CA_8 NUMBER,
    CN_CA_1 NUMBER,
    CN_CA_2 NUMBER,
    CN_CA_3 NUMBER,
    CN_CA_4 NUMBER,
    CN_CA_5 NUMBER,
    CN_CA_6 NUMBER,
    CN_CA_7 NUMBER,
    CN_CA_8 NUMBER,
    FLAG_CS_M3 NUMBER(1),
    FLAG_CS_PESO NUMBER(1),
    FLAG_CS_VOLUME NUMBER(1),
    FLAG_CS_CAMINHAO NUMBER(1),
    FLAG_CN_CAMINHAO NUMBER(1)    
  );
CREATE TABLE REDEX.TB_GD_CONTEINER
  (
    AUTONUM_GD_CNTR           NUMBER(10,0) NOT NULL ENABLE,
    AUTONUM_TRANSPORTADORA    NUMBER(8,0) NOT NULL ENABLE,
    AUTONUMVIAGEM             NUMBER(12,0) NOT NULL ENABLE,
    REFERENCE                 VARCHAR2(18 BYTE),
    ID_CONTEINER              VARCHAR2(12 BYTE),
    COD_ISO                   VARCHAR2(4 BYTE),
    POD                       VARCHAR2(3 BYTE),
    TARA                      NUMBER(8,3) DEFAULT 0,
    BRUTO                     NUMBER(8,3) DEFAULT 0,
    TEMPERATURA               VARCHAR2(5 BYTE),
    ESCALA                    VARCHAR2(1 BYTE),
    IMO1                      VARCHAR2(4 BYTE),
    IMO2                      VARCHAR2(4 BYTE),
    IMO3                      VARCHAR2(4 BYTE),
    IMO4                      VARCHAR2(4 BYTE),
    ONU1                      VARCHAR2(4 BYTE),
    ONU2                      VARCHAR2(4 BYTE),
    ONU3                      VARCHAR2(4 BYTE),
    ONU4                      VARCHAR2(4 BYTE),
    LACRE1                    VARCHAR2(15 BYTE),
    LACRE2                    VARCHAR2(15 BYTE),
    LACRE3                    VARCHAR2(15 BYTE),
    LACRE4                    VARCHAR2(15 BYTE),
    OBS                       VARCHAR2(50 BYTE),
    OH                        NUMBER(3,0) DEFAULT 0,
    OW                        NUMBER(3,0) DEFAULT 0,
    OWL                       NUMBER(3,0) DEFAULT 0,
    OL                        NUMBER(3,0) DEFAULT 0,
    AUTONUM_GD_RESERVA        NUMBER(8,0) DEFAULT 0 NOT NULL ENABLE,
    EF                        VARCHAR2(1 BYTE),
    TAMANHO                   NUMBER(2,0) DEFAULT 0,
    TIPOBASICO                VARCHAR2(2 BYTE),
    VOLUMES                   NUMBER(8,0),
    UMIDADE                   VARCHAR2(8 BYTE),
    VENTILACAO                VARCHAR2(8 BYTE),
    FLAG_ATIVO                NUMBER(1,0) DEFAULT 1,
    LACRE_SIF                 VARCHAR2(15 BYTE),
    VAGAO                     VARCHAR2(12 BYTE),
    TIPO_TRANSPORTE           VARCHAR2(1 BYTE),
    NUM_PROTOCOLO             NUMBER(6,0) DEFAULT 0,
    ANO_PROTOCOLO             NUMBER(4,0) DEFAULT 0,
    DT_IMPRESSAO              DATE,
    STATUS                    VARCHAR2(2 BYTE) DEFAULT 'GE',
    DT_CHEGADA_CNTR           DATE,
    DT_REGISTRO_CNTR          DATE,
    QUADRA_SUGERIDA           VARCHAR2(7 BYTE),
    LINE                      VARCHAR2(3 BYTE),
    FDES                      VARCHAR2(3 BYTE),
    LACRE5                    VARCHAR2(15 BYTE),
    LACRE6                    VARCHAR2(15 BYTE),
    LACRE7                    VARCHAR2(15 BYTE),
    AUTONUM_RESERVA           NUMBER(8,0) DEFAULT 0 NOT NULL ENABLE,
    AUTONUM_GD_MOTORISTA      NUMBER(8,0),
    DT_CHEGADA                DATE,
    MAXGROSS                  NUMBER(5,0),
    IDOPERACAO                NUMBER(12,0),
    FLAG_LATE                 NUMBER(1,0),
    AUTONUM_VEICULO           NUMBER,
    XML_DTE                   NUMBER(1,0) DEFAULT 0,
    XML_CODESP                NUMBER(1,0) DEFAULT 0,
    USRID                     NUMBER,
    FLAG_AUTONOMO             NUMBER(1,0),
    SEQ_FILA_OCR              NUMBER(9,0),
    DT_XML_AG                 DATE,
    DT_XML_IN                 DATE,
    DT_XML_OUT                DATE,
    DT_ULTIMA_ATUALIZACAO     DATE,
    ID_NAVIS_GATE_APPOINTMENT NUMBER(10,0),
    ID_NAVIS_TELA             VARCHAR2(100 BYTE),
    ID_XML_MSG_NAVIS          NUMBER(10,0),
    USUARIO_ALTERACAO_NAVIS   VARCHAR2(100 BYTE),
    CONSTRAINT PK_TB_GD_CONTEINER PRIMARY KEY (AUTONUM_GD_CNTR)
  );
CREATE INDEX REDEX.IDX_GD_CNTR ON REDEX.TB_GD_CONTEINER
  (
    AUTONUM_TRANSPORTADORA,
    AUTONUMVIAGEM,
    ID_CONTEINER
  );
CREATE INDEX REDEX.IDX_GD_CNTR_VG ON REDEX.TB_GD_CONTEINER
  (
    AUTONUMVIAGEM,
    ID_CONTEINER
  );
CREATE INDEX REDEX.IDX_GD_CONTEINER_PROT ON REDEX.TB_GD_CONTEINER
  (
    NUM_PROTOCOLO,
    ANO_PROTOCOLO
  );
CREATE INDEX REDEX.IND_RESERVA ON REDEX.TB_GD_CONTEINER
  (
    AUTONUM_GD_RESERVA
  );
CREATE INDEX REDEX.IND_TAMANHO ON REDEX.TB_GD_CONTEINER
  ( TAMANHO
  );
CREATE INDEX REDEX.IX_TB_GD_CONTEINER_POD ON REDEX.TB_GD_CONTEINER
  ( POD
  );
CREATE INDEX REDEX.IX_TB_GD_CONTEI_AUTONVIAG ON REDEX.TB_GD_CONTEINER
  (
    AUTONUMVIAGEM
  );
  
  CREATE TABLE REDEX.TB_PARAMETROS_GPD
  (
    AUTONUM   NUMBER NOT NULL ENABLE,
    CODIGO    NUMBER(3,0),
    DESCR     VARCHAR2(50 BYTE),
    INTERVALO NUMBER(2,0),
    PRIMARY KEY (AUTONUM)
  );
CREATE TABLE REDEX.TB_PARAMETROS_GPD_PERIODOS
  (
    AUTONUM               NUMBER NOT NULL ENABLE,
    AUTONUM_PARAMETRO_GPD NUMBER,
    AUTONUM_SERVICO       NUMBER,
    PERIODO_INICIAL       DATE,
    PERIODO_FINAL         DATE,
    QTDE                  NUMBER,
    DIA_SEMANA            NUMBER(1,0),
    PRIMARY KEY (AUTONUM)
  );
CREATE INDEX REDEX.IDX_PARAMETROS_GPD_PERIODOS ON REDEX.TB_PARAMETROS_GPD_PERIODOS
  (
    AUTONUM_PARAMETRO_GPD
  ) ;
CREATE TABLE REDEX.TB_PARAMETROS_GPD_SERVICOS
  (
    AUTONUM      NUMBER NOT NULL ENABLE,
    DESCR        VARCHAR2(50 BYTE),
    SERVICO_GATE VARCHAR2(1 BYTE),
    PRIMARY KEY (AUTONUM)
  );

  CREATE TABLE REDEX.TB_GD_RESERVA
  (
    AUTONUM_GD_RESERVA      NUMBER(8,0) DEFAULT 0 NOT NULL ENABLE,
    PERIODO_INICIAL         DATE,
    PERIODO_FINAL           DATE,
    LIMITE_PESO             NUMBER DEFAULT 0,
    LIMITE_VOLUMES          NUMBER DEFAULT 0,
    LIMITE_M3               NUMBER DEFAULT 0,
    LIMITE_CAMINHOES        NUMBER DEFAULT 0,
    TIPO                    VARCHAR2(2 BYTE),
    SERVICO_GATE            VARCHAR2(1 BYTE) DEFAULT 'E',
    PATIO                   NUMBER(1,0) DEFAULT 1,
    FLAG_VIP                NUMBER(1,0) DEFAULT 0,    
    CONSTRAINT PK_TB_GD_RESERVA PRIMARY KEY (AUTONUM_GD_RESERVA)
  );
  
  CREATE INDEX REDEX.IND_GD_RESERVA ON REDEX.TB_GD_RESERVA
    (
      SERVICO_GATE,
      PERIODO_INICIAL,
      PERIODO_FINAL
    ) ;
  

  
CREATE SEQUENCE REDEX.SEQ_GD_CONTEINER MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE NOORDER NOCYCLE;
CREATE SEQUENCE REDEX.SEQ_GD_PROT_2015 MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE NOORDER NOCYCLE;
CREATE SEQUENCE REDEX.AGENDAMENTO_WEB_CNTR_CA MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 18 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_CNTR_CA MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 21 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_CNTR_NF MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 2003 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_CS MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 2011 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_CS_CA MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 2013 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_CS_CA_NF MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 2001 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_CS_ITENS MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 2010 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_CS_NF MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 2012 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_PROT_2015 MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 2031 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_AGENDAMENTO_WEB_RESERVAS MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 2023 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_PARAMETROS_GPD MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_PARAMETROS_GPD_PERIODOS MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE REDEX.SEQ_PARAMETROS_GPD_SERVICOS MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE NOORDER NOCYCLE ;
CREATE SEQUENCE  REDEX.SEQ_GD_RESERVA  MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  NOORDER  NOCYCLE ;

commit;
  
  CREATE OR REPLACE  VIEW REDEX.VW_AGENDAMENTO_WEB_ENTRADA_CN (TIPO, DATA, VEICULOS, CNTRS) AS 
  SELECT 'EC'                           AS TIPO,
  TO_CHAR(GN.DT_GATE_IN,'DD/MM/YYYY') AS DATA,
  COUNT(DISTINCT GN.AUTONUM)          AS VEICULOS,
  COUNT(1)                            AS CNTRS
FROM TB_AMR_GATE AMR
INNER JOIN TB_GATE_NEW GN
ON AMR.GATE                   =GN.AUTONUM
WHERE GN.FUNCAO_GATE_ENTRADA IN (205,206)
GROUP BY TO_CHAR(GN.DT_GATE_IN,'DD/MM/YYYY'); 
 

    CREATE OR REPLACE VIEW REDEX.VW_AGENDAMENTO_WEB_CN_CA_PROT (AUTONUM, RESERVA, AUTONUM_MOTORISTA, AUTONUM_VEICULO, AUTONUM_TRANSPORTADORA, NOME, CNH, NEXTEL, RG, PLACA_CAVALO, PLACA_CARRETA, MODELO, VEICULO, NUM_PROTOCOLO, ANO_PROTOCOLO, NAVIO_VIAGEM, DEAD_LINE, ID_CONTEINER, PROTOCOLO, STATUS, PERIODO, TRANSPORTADORA, PORTO_DESTINO, PORTO_ORIGEM, EXPORTADOR) AS 
  SELECT 
    A.AUTONUM,
    A.RESERVA,
    A.AUTONUM_MOTORISTA,
    A.AUTONUM_VEICULO,
    A.AUTONUM_TRANSPORTADORA,
    D.NOME || ' - ' || D.CNH AS NOME,
    D.CNH,
    D.NEXTEL,
    D.RG,
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    E.MODELO,    
    E.PLACA_CAVALO || ' / ' || E.PLACA_CARRETA AS VEICULO,
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,    
    TRIM(J.DESCRICAO_NAV) || '/' || C.NUM_VIAGEM AS NAVIO_VIAGEM,
    TO_CHAR(C.DT_DEAD_LINE,'DD/MM/YYYY HH24:MI') DEAD_LINE,
    A.ID_CONTEINER,
    A.NUM_PROTOCOLO || '/' || A.ANO_PROTOCOLO AS PROTOCOLO,
    CASE  WHEN A.STATUS='GE' THEN 'Gerado' ELSE 'Impresso' END STATUS,
    TO_CHAR(F.PERIODO_INICIAL,'DD/MM/YYYY HH24:MI') || ' - ' || TO_CHAR(F.PERIODO_FINAL,'DD/MM/YYYY HH24:MI') PERIODO,
    K.RAZAO TRANSPORTADORA,    
    H.DESCRICAO_POR AS PORTO_DESTINO,
    I.DESCRICAO_POR AS PORTO_ORIGEM,
    G.RAZAO AS EXPORTADOR
FROM 
    REDEX.TB_AGENDAMENTO_WEB_CNTR_CA A
INNER JOIN 
    REDEX.TB_BOOKING B ON A.RESERVA = B.REFERENCE
INNER JOIN 
    REDEX.TB_VIAGENS C ON B.AUTONUM_VIA = C.AUTONUM_VIA    
INNER JOIN 
    OPERADOR.TB_AG_MOTORISTAS D ON A.AUTONUM_MOTORISTA = D.AUTONUM
INNER JOIN 
    OPERADOR.TB_AG_VEICULOS E ON A.AUTONUM_VEICULO = E.AUTONUM
LEFT JOIN 
    REDEX.TB_GD_RESERVA F ON A.AUTONUM_GD_RESERVA = F.AUTONUM_GD_RESERVA
LEFT JOIN     
    REDEX.TB_CAD_PARCEIROS G ON B.AUTONUM_EXPORTADOR = G.AUTONUM
LEFT JOIN     
    REDEX.TB_CAD_PORTOS H ON B.AUTONUM_POD = H.AUTONUM_POR        
LEFT JOIN     
    REDEX.TB_CAD_PORTOS I ON B.AUTONUM_FDES = I.AUTONUM_POR            
LEFT JOIN     
    REDEX.TB_CAD_NAVIOS J ON C.AUTONUM_NAV = J.AUTONUM_NAV
LEFT JOIN     
    OPERADOR.TB_CAD_TRANSPORTADORAS K ON A.AUTONUM_TRANSPORTADORA = K.AUTONUM
GROUP BY
A.AUTONUM,
    A.RESERVA,
    A.AUTONUM_MOTORISTA,
    A.AUTONUM_VEICULO,
    A.AUTONUM_TRANSPORTADORA,
    D.NOME,
    D.CNH,
    D.CNH,
    D.NEXTEL,
    D.RG,
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    E.MODELO,    
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,    
    J.DESCRICAO_NAV,
    C.NUM_VIAGEM,
    C.DT_DEAD_LINE,
    A.ID_CONTEINER,
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,
    A.STATUS,
    F.PERIODO_INICIAL,
    F.PERIODO_FINAL,
    K.RAZAO,    
    H.DESCRICAO_POR,
    I.DESCRICAO_POR,
    G.RAZAO;
 
 CREATE OR REPLACE FORCE VIEW REDEX.VW_AGENDAMENTO_WEB_CN_PROT (AUTONUM_GD_CNTR, REFERENCE, AUTONUM_GD_MOTORISTA, AUTONUM_VEICULO, AUTONUMVIAGEM, ID_CONTEINER, TARA, BRUTO, LACRE1, LACRE2, LACRE3, LACRE4, LACRE5, LACRE6, LACRE7, LACRE_SIF, VENTILACAO, UMIDADE, VOLUMES, TEMPERATURA, ESCALA, ALTURA, LATERAL_DIREITA, LATERAL_ESQUERDA, COMPRIMENTO, TAMANHO, TIPOBASICO, AUTONUM_RESERVA, IMO1, IMO2, IMO3, IMO4, ONU1, ONU2, ONU3, ONU4, LINE, NOME, PLACA_CAVALO, PLACA_CARRETA, NUM_PROTOCOLO, ANO_PROTOCOLO, ID_TRANSPORTADORA, CNH, VEICULO, NAVIO_VIAGEM, DEAD_LINE, CONTEINER, PROTOCOLO, STATUS, PERIODO, TRANSPORTADORA, MODELO, NEXTEL, RG, POD, FDES, EXPORTADOR, COD_ISO, AUTONUM_GD_RESERVA, PATIO) AS 
  SELECT 
    A.AUTONUM_GD_CNTR,
    A.REFERENCE,
    A.AUTONUM_GD_MOTORISTA,
    A.AUTONUM_VEICULO,
    A.AUTONUMVIAGEM,
    A.ID_CONTEINER,
    A.TARA,
    A.BRUTO,
    A.LACRE1,
    A.LACRE2,
    A.LACRE3,
    A.LACRE4,
    A.LACRE5,
    A.LACRE6,
    A.LACRE7,
    A.LACRE_SIF,
    A.VENTILACAO,
    A.UMIDADE,
    A.VOLUMES,
    A.TEMPERATURA,
    A.ESCALA,
    A.OH ALTURA,
    A.OW LATERAL_DIREITA,
    A.OWL LATERAL_ESQUERDA,
    A.OL COMPRIMENTO,
    A.TAMANHO,
    A.TIPOBASICO,
    A.AUTONUM_RESERVA,
    A.IMO1,
    A.IMO2,
    A.IMO3,
    A.IMO4,
    A.ONU1,
    A.ONU2,
    A.ONU3,
    A.ONU4,
    A.LINE,
    B.NOME
    || ' - '
    || B.CNH AS NOME,
    C.PLACA_CAVALO,
    C.PLACA_CARRETA,
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,
    B.ID_TRANSPORTADORA,
    B.CNH,
    C.PLACA_CAVALO
    || ' / '
    || C.PLACA_CARRETA AS VEICULO,
    TRIM(I.DESCRICAO_NAV)
    || '/'
    || G.NUM_VIAGEM AS NAVIO_VIAGEM,
    TO_CHAR(G.DT_DEAD_LINE,'DD/MM/YYYY HH24:MI') DEAD_LINE,
    A.ID_CONTEINER
    || ' '
    || A.TIPOBASICO
    || ' '
    || A.TAMANHO AS CONTEINER,
    A.NUM_PROTOCOLO
    || '/'
    || A.ANO_PROTOCOLO AS PROTOCOLO,
    CASE WHEN A.STATUS='GE' THEN 'Gerado' ELSE 'Impresso' END STATUS,
    TO_CHAR(D.PERIODO_INICIAL,'DD/MM/YYYY HH24:MI')
    || ' - '
    || TO_CHAR(D.PERIODO_FINAL,'DD/MM/YYYY HH24:MI') PERIODO,
    E.RAZAO TRANSPORTADORA,
    C.MODELO,
    B.NEXTEL,
    B.RG,
    A.POD,
    A.FDES,
    H.RAZAO AS EXPORTADOR,
    A.COD_ISO,
    A.AUTONUM_GD_RESERVA,
    F.AUTONUM_PATIOS AS PATIO
FROM 
    REDEX.TB_GD_CONTEINER A
INNER JOIN 
    OPERADOR.TB_AG_MOTORISTAS B ON A.AUTONUM_GD_MOTORISTA = B.AUTONUM
INNER JOIN 
    OPERADOR.TB_AG_VEICULOS C ON A.AUTONUM_VEICULO = C.AUTONUM
LEFT JOIN 
    REDEX.TB_GD_RESERVA D ON A.AUTONUM_GD_RESERVA = D.AUTONUM_GD_RESERVA
INNER JOIN 
    OPERADOR.TB_CAD_TRANSPORTADORAS E ON A.AUTONUM_TRANSPORTADORA = E.AUTONUM
INNER JOIN
    REDEX.TB_BOOKING F ON A.REFERENCE = F.REFERENCE
INNER JOIN
    REDEX.TB_VIAGENS G ON F.AUTONUM_VIA = G.AUTONUM_VIA    
LEFT JOIN 
    REDEX.TB_CAD_PARCEIROS H ON F.AUTONUM_EXPORTADOR = H.AUTONUM        
LEFT JOIN 
    REDEX.TB_CAD_NAVIOS I ON G.AUTONUM_NAV = I.AUTONUM_NAV            
ORDER BY 
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,
    A.REFERENCE;
 
  
  
  CREATE OR REPLACE VIEW REDEX.VW_AGENDAMENTO_WEB_CONS_CN (AUTONUM_GD_CNTR, RESERVA, NAVIO_VIAGEM, PROTOCOLO, PERIODO, MOTORISTA, CNH, VEICULO, DEAD_LINE, STATUS, AUTONUM_TRANSPORTADORA, CONTEINER, PORTO_DESTINO, EXPORTADOR) AS 
  SELECT A.AUTONUM_GD_CNTR,
  A.REFERENCE AS RESERVA,
  TRIM(I.DESCRICAO_NAV)
  || '/'
  || C.NUM_VIAGEM AS NAVIO_VIAGEM,
  A.NUM_PROTOCOLO
  || '/'
  || A.ANO_PROTOCOLO PROTOCOLO,
  TO_CHAR(F.PERIODO_INICIAL,'DD/MM/YYYY HH24:MI')
  || ' - '
  || TO_CHAR(F.PERIODO_FINAL,'DD/MM/YYYY HH24:MI') PERIODO,
  D.NOME AS MOTORISTA,
  D.CNH,
  E.PLACA_CAVALO
  || ' / '
  || E.PLACA_CARRETA AS VEICULO,
  TO_CHAR(C.DT_DEAD_LINE,'DD/MM/YYYY HH24:MI') DEAD_LINE,
  CASE WHEN A.STATUS='GE' THEN 'Gerado' ELSE 'Impresso' END STATUS,
  A.AUTONUM_TRANSPORTADORA,
  A.ID_CONTEINER
  || ' '
  || A.TIPOBASICO
  || ' '
  || A.TAMANHO    AS CONTEINER,
  H.DESCRICAO_POR AS PORTO_DESTINO,
  G.RAZAO         AS EXPORTADOR
FROM REDEX.TB_GD_CONTEINER A
INNER JOIN REDEX.TB_BOOKING B
ON A.REFERENCE = B.REFERENCE
INNER JOIN REDEX.TB_VIAGENS C
ON B.AUTONUM_VIA = C.AUTONUM_VIA
INNER JOIN OPERADOR.TB_AG_MOTORISTAS D
ON A.AUTONUM_GD_MOTORISTA = D.AUTONUM
INNER JOIN OPERADOR.TB_AG_VEICULOS E
ON A.AUTONUM_VEICULO = E.AUTONUM
LEFT JOIN REDEX.TB_GD_RESERVA F
ON A.AUTONUM_GD_RESERVA = F.AUTONUM_GD_RESERVA
LEFT JOIN REDEX.TB_CAD_PARCEIROS G
ON B.AUTONUM_EXPORTADOR = G.AUTONUM
LEFT JOIN REDEX.TB_CAD_PORTOS H
ON A.POD = H.PENTAGRAMA
LEFT JOIN REDEX.TB_CAD_NAVIOS I
ON C.AUTONUM_NAV = I.AUTONUM_NAV
GROUP BY
  A.AUTONUM_GD_CNTR,
  A.REFERENCE,
  I.DESCRICAO_NAV,
  C.NUM_VIAGEM,
  A.NUM_PROTOCOLO,
  A.ANO_PROTOCOLO,
  F.PERIODO_INICIAL,
  F.PERIODO_FINAL,
  D.NOME,
  D.CNH,
  E.PLACA_CAVALO,  
  E.PLACA_CARRETA,
  C.DT_DEAD_LINE,
  A.STATUS,
  A.AUTONUM_TRANSPORTADORA,
  A.ID_CONTEINER, 
  A.TIPOBASICO,
  A.TAMANHO,
  H.DESCRICAO_POR,
  G.RAZAO;
 

 
  
  CREATE OR REPLACE VIEW REDEX.VW_AGENDAMENTO_WEB_CONS_CN_CA (AUTONUM, RESERVA, NAVIO_VIAGEM, PROTOCOLO, PERIODO, MOTORISTA, CNH, VEICULO, DEAD_LINE, STATUS, AUTONUM_TRANSPORTADORA, CONTEINER, PORTO_DESTINO, EXPORTADOR) AS 
  SELECT 
    A.AUTONUM,
    A.RESERVA,
    TRIM(I.DESCRICAO_NAV) || '/' || C.NUM_VIAGEM AS NAVIO_VIAGEM,
    A.NUM_PROTOCOLO || '/' || A.ANO_PROTOCOLO PROTOCOLO,
    TO_CHAR(F.PERIODO_INICIAL,'DD/MM/YYYY HH24:MI') || ' - ' || TO_CHAR(F.PERIODO_FINAL,'DD/MM/YYYY HH24:MI') PERIODO,
    D.NOME AS MOTORISTA,
    D.CNH,
    E.PLACA_CAVALO || ' / ' || E.PLACA_CARRETA AS VEICULO,
    TO_CHAR(C.DT_DEAD_LINE,'DD/MM/YYYY HH24:MI') DEAD_LINE,
    CASE WHEN A.STATUS='GE' THEN 'Gerado' ELSE 'Impresso' END STATUS,
    A.AUTONUM_TRANSPORTADORA,
    A.ID_CONTEINER CONTEINER,
    H.DESCRICAO_POR AS PORTO_DESTINO,
    G.RAZAO AS EXPORTADOR
FROM 
    REDEX.TB_AGENDAMENTO_WEB_CNTR_CA A
INNER JOIN 
    REDEX.TB_BOOKING B ON A.RESERVA = B.REFERENCE
INNER JOIN 
    REDEX.TB_VIAGENS C ON B.AUTONUM_VIA = C.AUTONUM_VIA    
INNER JOIN 
    OPERADOR.TB_AG_MOTORISTAS D ON A.AUTONUM_MOTORISTA = D.AUTONUM
INNER JOIN 
    OPERADOR.TB_AG_VEICULOS E ON A.AUTONUM_VEICULO = E.AUTONUM
LEFT JOIN 
    REDEX.TB_GD_RESERVA F ON A.AUTONUM_GD_RESERVA = F.AUTONUM_GD_RESERVA
LEFT JOIN     
    REDEX.TB_CAD_PARCEIROS G ON B.AUTONUM_EXPORTADOR = G.AUTONUM
LEFT JOIN     
    REDEX.TB_CAD_PORTOS H ON B.AUTONUM_POD = H.AUTONUM_POR        
LEFT JOIN     
    REDEX.TB_CAD_NAVIOS I ON C.AUTONUM_NAV = I.AUTONUM_NAV
GROUP BY
    A.AUTONUM,
    A.RESERVA,
    I.DESCRICAO_NAV,
    C.NUM_VIAGEM,
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,
    F.PERIODO_INICIAL,
    F.PERIODO_FINAL,
    D.NOME,
    D.CNH,
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    C.DT_DEAD_LINE,
    A.STATUS,
    A.AUTONUM_TRANSPORTADORA,
    A.ID_CONTEINER,
    H.DESCRICAO_POR,
    G.RAZAO;
 

  
  
  CREATE OR REPLACE VIEW REDEX.VW_AGENDAMENTO_WEB_CONS_CS (AUTONUM, RESERVA, NAVIO_VIAGEM, NUM_PROTOCOLO, PROTOCOLO, PERIODO, NOME, CNH, VEICULO, DT_DEAD_LINE, STATUS, AUTONUM_TRANSPORTADORA) AS 
  SELECT 
    A.AUTONUM,
    A.RESERVA,
    TRIM(I.DESCRICAO_NAV) || '/' || C.NUM_VIAGEM AS NAVIO_VIAGEM,
    A.NUM_PROTOCOLO,
	A.NUM_PROTOCOLO || '/' || A.ANO_PROTOCOLO PROTOCOLO,
    TO_CHAR(F.PERIODO_INICIAL,'DD/MM/YYYY HH24:MI') || ' - ' || TO_CHAR(F.PERIODO_FINAL,'DD/MM/YYYY HH24:MI') PERIODO,
    D.NOME,
    D.CNH,
    E.PLACA_CAVALO || ' / ' || E.PLACA_CARRETA AS VEICULO,
    TO_CHAR(C.DT_DEAD_LINE,'DD/MM/YYYY HH24:MI') DT_DEAD_LINE,
    CASE WHEN A.STATUS='GE' THEN 'Gerado' ELSE 'Impresso' END STATUS,
    A.AUTONUM_TRANSPORTADORA
FROM 
    REDEX.TB_AGENDAMENTO_WEB_CS A
INNER JOIN 
    REDEX.TB_BOOKING B ON A.RESERVA = B.REFERENCE
INNER JOIN 
    REDEX.TB_VIAGENS C ON B.AUTONUM_VIA = C.AUTONUM_VIA    
INNER JOIN 
    OPERADOR.TB_AG_MOTORISTAS D ON A.AUTONUM_MOTORISTA = D.AUTONUM
INNER JOIN 
    OPERADOR.TB_AG_VEICULOS E ON A.AUTONUM_VEICULO = E.AUTONUM
LEFT JOIN 
    REDEX.TB_GD_RESERVA F ON A.AUTONUM_GD_RESERVA = F.AUTONUM_GD_RESERVA
LEFT JOIN     
    REDEX.TB_CAD_PARCEIROS G ON B.AUTONUM_EXPORTADOR = G.AUTONUM
LEFT JOIN     
    REDEX.TB_CAD_PORTOS H ON B.AUTONUM_POD = H.AUTONUM_POR        
LEFT JOIN     
    REDEX.TB_CAD_NAVIOS I ON C.AUTONUM_NAV = I.AUTONUM_NAV
GROUP BY
    A.AUTONUM,
    A.RESERVA,
    I.DESCRICAO_NAV,
    C.NUM_VIAGEM,
    A.NUM_PROTOCOLO,
    A.NUM_PROTOCOLO, 
    A.ANO_PROTOCOLO,
    F.PERIODO_INICIAL,
    F.PERIODO_FINAL,
    D.NOME,
    D.CNH,
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    C.DT_DEAD_LINE,
    A.STATUS,
    A.AUTONUM_TRANSPORTADORA;
 

  
  
  CREATE OR REPLACE VIEW REDEX.VW_AGENDAMENTO_WEB_CONS_CS_CA (AUTONUM, RESERVA, NAVIO_VIAGEM, PROTOCOLO, PERIODO, NOME, CNH, VEICULO, DT_DEAD_LINE, STATUS, AUTONUM_TRANSPORTADORA) AS 
  SELECT 
    A.AUTONUM,
    B.REFERENCE AS RESERVA,
    TRIM(G.DESCRICAO_NAV) || '/' || C.NUM_VIAGEM AS NAVIO_VIAGEM,
    A.NUM_PROTOCOLO || '/' || A.ANO_PROTOCOLO PROTOCOLO,
    TO_CHAR(F.PERIODO_INICIAL,'DD/MM/YYYY HH24:MI') || ' - ' || TO_CHAR(F.PERIODO_FINAL,'DD/MM/YYYY HH24:MI') PERIODO,
    D.NOME,
    D.CNH,
    E.PLACA_CAVALO || ' / ' || E.PLACA_CARRETA AS VEICULO,
    TO_CHAR(C.DT_DEAD_LINE,'DD/MM/YYYY HH24:MI') DT_DEAD_LINE,
  CASE WHEN A.STATUS='GE' THEN 'Gerado' ELSE 'Impresso' END STATUS,
    A.AUTONUM_TRANSPORTADORA
FROM 
    REDEX.TB_AGENDAMENTO_WEB_CS_CA A
INNER JOIN 
    REDEX.TB_BOOKING B ON A.RESERVA = B.REFERENCE  
INNER JOIN 
    REDEX.TB_VIAGENS C ON A.AUTONUM_VIAGEM = C.AUTONUM_VIA  
INNER JOIN 
    OPERADOR.TB_AG_MOTORISTAS D ON A.AUTONUM_MOTORISTA = D.AUTONUM
INNER JOIN 
    OPERADOR.TB_AG_VEICULOS E ON A.AUTONUM_VEICULO = E.AUTONUM
LEFT JOIN 
    REDEX.TB_GD_RESERVA F ON A.AUTONUM_GD_RESERVA = F.AUTONUM_GD_RESERVA
LEFT JOIN 
    REDEX.TB_CAD_NAVIOS G ON C.AUTONUM_NAV = G.AUTONUM_NAV
GROUP BY
  A.AUTONUM,
    B.REFERENCE,
    G.DESCRICAO_NAV,
    C.NUM_VIAGEM,
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,
    F.PERIODO_INICIAL,
    F.PERIODO_FINAL,
    D.NOME,
    D.CNH,
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    C.DT_DEAD_LINE,
    A.STATUS,
    AUTONUM_TRANSPORTADORA;
 

  
    CREATE OR REPLACE VIEW REDEX.VW_AGENDAMENTO_WEB_CS_CA_PROT (AUTONUM, RESERVA, NAVIO_VIAGEM, PROTOCOLO, PERIODO, NOME, CNH, RG, NEXTEL, PLACA_CAVALO, PLACA_CARRETA, MODELO, DT_DEAD_LINE, STATUS, AUTONUM_TRANSPORTADORA, TRANSPORTADORA, EXPORTADOR, PORTO_DESTINO) AS 
  SELECT 
    A.AUTONUM,
    B.REFERENCE AS RESERVA,
    TRIM(G.DESCRICAO_NAV) || '/' || C.NUM_VIAGEM AS NAVIO_VIAGEM,
    A.NUM_PROTOCOLO || '/' || A.ANO_PROTOCOLO PROTOCOLO,
    TO_CHAR(F.PERIODO_INICIAL,'DD/MM/YYYY HH24:MI') || ' - ' || TO_CHAR(F.PERIODO_FINAL,'DD/MM/YYYY HH24:MI') PERIODO,
    D.NOME,
    D.CNH,
    D.RG,
    D.NEXTEL,    
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    E.MODELO,
    TO_CHAR(C.DT_DEAD_LINE,'DD/MM/YYYY HH24:MI') DT_DEAD_LINE,
    CASE WHEN A.STATUS='GE' THEN 'Gerado' ELSE 'Impresso' END STATUS,
    A.AUTONUM_TRANSPORTADORA,
    H.RAZAO AS TRANSPORTADORA,
    I.RAZAO AS EXPORTADOR,
    J.DESCRICAO_POR AS PORTO_DESTINO
FROM 
    REDEX.TB_AGENDAMENTO_WEB_CS_CA A
INNER JOIN 
    REDEX.TB_BOOKING B ON A.RESERVA = B.REFERENCE  
INNER JOIN 
    REDEX.TB_VIAGENS C ON A.AUTONUM_VIAGEM = C.AUTONUM_VIA  
INNER JOIN 
    OPERADOR.TB_AG_MOTORISTAS D ON A.AUTONUM_MOTORISTA = D.AUTONUM
INNER JOIN 
    OPERADOR.TB_AG_VEICULOS E ON A.AUTONUM_VEICULO = E.AUTONUM
LEFT JOIN 
    REDEX.TB_GD_RESERVA F ON A.AUTONUM_GD_RESERVA = F.AUTONUM_GD_RESERVA
LEFT JOIN 
    REDEX.TB_CAD_NAVIOS G ON C.AUTONUM_NAV = G.AUTONUM_NAV
LEFT JOIN 
    OPERADOR.TB_CAD_TRANSPORTADORAS H ON A.AUTONUM_TRANSPORTADORA = H.AUTONUM
LEFT JOIN 
    REDEX.TB_CAD_PARCEIROS I ON B.AUTONUM_EXPORTADOR = I.AUTONUM
LEFT JOIN 
    REDEX.TB_CAD_PORTOS J ON B.AUTONUM_POD = J.AUTONUM_POR
GROUP BY
A.AUTONUM,
    B.REFERENCE,
    G.DESCRICAO_NAV,
    C.NUM_VIAGEM,
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,
    F.PERIODO_INICIAL,
    F.PERIODO_FINAL,
    D.NOME,
    D.CNH,
    D.RG,
    D.NEXTEL,    
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    E.MODELO,
    C.DT_DEAD_LINE,
    A.STATUS,
    A.AUTONUM_TRANSPORTADORA,
    H.RAZAO,
    I.RAZAO,
    J.DESCRICAO_POR;
 

  
    CREATE OR REPLACE VIEW REDEX.VW_AGENDAMENTO_WEB_CS_PROT (AUTONUM, TRANSPORTADORA, PLACA_CAVALO, PLACA_CARRETA, MODELO, NOME, CNH, RG, NEXTEL, RESERVA, DT_DEAD_LINE, PORTO_DESTINO, EXPORTADOR, NAVIO_VIAGEM, NUM_PROTOCOLO, PROTOCOLO, PERIODO) AS 
  SELECT 
    A.AUTONUM,
    J.RAZAO TRANSPORTADORA,
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    E.MODELO,
    D.NOME,
    D.CNH,
    D.RG,
    D.NEXTEL,
    A.RESERVA,
    TO_CHAR(C.DT_DEAD_LINE,'DD/MM/YYYY HH24:MI') DT_DEAD_LINE,
    H.DESCRICAO_POR AS PORTO_DESTINO,
    G.RAZAO AS EXPORTADOR,
    TRIM(I.DESCRICAO_NAV) || '/' || C.NUM_VIAGEM AS NAVIO_VIAGEM,
    A.NUM_PROTOCOLO,
	A.NUM_PROTOCOLO || '/' || A.ANO_PROTOCOLO AS PROTOCOLO,
    TO_CHAR(F.PERIODO_INICIAL,'DD/MM/YYYY HH24:MI') || ' - ' || TO_CHAR(F.PERIODO_FINAL,'DD/MM/YYYY HH24:MI') PERIODO
FROM 
    REDEX.TB_AGENDAMENTO_WEB_CS A
INNER JOIN 
    REDEX.TB_BOOKING B ON A.RESERVA = B.REFERENCE
INNER JOIN 
    REDEX.TB_VIAGENS C ON B.AUTONUM_VIA = C.AUTONUM_VIA    
INNER JOIN 
    OPERADOR.TB_AG_MOTORISTAS D ON A.AUTONUM_MOTORISTA = D.AUTONUM
INNER JOIN 
    OPERADOR.TB_AG_VEICULOS E ON A.AUTONUM_VEICULO = E.AUTONUM
LEFT JOIN 
    REDEX.TB_GD_RESERVA F ON A.AUTONUM_GD_RESERVA = F.AUTONUM_GD_RESERVA
LEFT JOIN     
    REDEX.TB_CAD_PARCEIROS G ON B.AUTONUM_EXPORTADOR = G.AUTONUM
LEFT JOIN     
    REDEX.TB_CAD_PORTOS H ON B.AUTONUM_POD = H.AUTONUM_POR        
LEFT JOIN     
    REDEX.TB_CAD_NAVIOS I ON C.AUTONUM_NAV = I.AUTONUM_NAV
LEFT JOIN     
    OPERADOR.TB_CAD_TRANSPORTADORAS J ON A.AUTONUM_TRANSPORTADORA = J.AUTONUM
GROUP BY
    A.AUTONUM,
    J.RAZAO,
    E.PLACA_CAVALO,
    E.PLACA_CARRETA,
    E.MODELO,
    D.NOME,
    D.CNH,
    D.RG,
    D.NEXTEL,
    A.RESERVA,
    C.DT_DEAD_LINE,
    H.DESCRICAO_POR,
    G.RAZAO,
    I.DESCRICAO_NAV,
    C.NUM_VIAGEM,
    A.NUM_PROTOCOLO,
    A.NUM_PROTOCOLO,
    A.ANO_PROTOCOLO,
    F.PERIODO_INICIAL,
    F.PERIODO_FINAL;
  
CREATE OR REPLACE FORCE VIEW REDEX.VW_AGENDAMENTO_WEB_DADOS_BOO (AUTONUM, RESERVA, FLAG_CS, FLAG_CNTR, QUANTIDADE, PESO, METRAGEM_CUBICA, VOLUMES, ARMADOR, NAVIO, EXPORTADOR, NVOCC, AUTONUM_VIA, NUM_VIAGEM, PORTO_ORIGEM, PORTO_DESTINO, DT_DEAD_LINE, AUTONUM_VIAGEM, PATIO) AS 
  SELECT DISTINCT A.AUTONUM_BOO AS AUTONUM,
  A.REFERENCE                 AS RESERVA,
  C.FLAG_CS,
  C.FLAG_CNTR,
  NVL(
  CASE
    WHEN NVL(C.FLAG_CS,0) > 0
    THEN
      (SELECT SUM(QTDE) QUANTIDADE
      FROM REDEX.TB_BOOKING_CARGA
      WHERE AUTONUM_BOO = A.AUTONUM_BOO
      AND FLAG_CS       = 1
      )
    WHEN NVL(C.FLAG_CNTR,0) > 0
    AND NVL(C.FLAG_CS,0)    = 0
    THEN
      (SELECT SUM(QTDE) QUANTIDADE
      FROM REDEX.TB_BOOKING_CARGA
      WHERE AUTONUM_BOO = A.AUTONUM_BOO
      AND FLAG_CS       = 0
      )
  END,0) QUANTIDADE,
  NVL(
  CASE
    WHEN NVL(C.FLAG_CS,0) > 0
    THEN
      (SELECT SUM(PESO_BRUTO) PESO_BRUTO
      FROM REDEX.TB_BOOKING_CARGA
      WHERE AUTONUM_BOO = A.AUTONUM_BOO
      AND FLAG_CS       = 1
      )
    WHEN NVL(C.FLAG_CNTR,0) > 0
    AND NVL(C.FLAG_CS,0)    = 0
    THEN
      (SELECT SUM(PESO_BRUTO) PESO_BRUTO
      FROM REDEX.TB_BOOKING_CARGA
      WHERE AUTONUM_BOO = A.AUTONUM_BOO
      AND FLAG_CS       = 0
      )
  END,0) PESO,
  NVL(
  CASE
    WHEN NVL(C.FLAG_CS,0) > 0
    THEN
      (SELECT SUM(VOLUME) VOLUME
      FROM REDEX.TB_BOOKING_CARGA
      WHERE AUTONUM_BOO = A.AUTONUM_BOO
      AND FLAG_CS       = 1
      )
    WHEN NVL(C.FLAG_CNTR,0) > 0
    AND NVL(C.FLAG_CS,0)    = 0
    THEN
      (SELECT SUM(VOLUME) VOLUME
      FROM REDEX.TB_BOOKING_CARGA
      WHERE AUTONUM_BOO = A.AUTONUM_BOO
      AND FLAG_CS       = 0
      )
  END,0) METRAGEM_CUBICA,
  NVL(
  CASE
    WHEN NVL(C.FLAG_CS,0) > 0
    THEN
      (SELECT SUM(QTDE) QUANTIDADE
      FROM REDEX.TB_BOOKING_CARGA
      WHERE AUTONUM_BOO = A.AUTONUM_BOO
      AND FLAG_CS       = 1
      )
    WHEN NVL(C.FLAG_CNTR,0) > 0
    AND NVL(C.FLAG_CS,0)    = 0
    THEN
      (SELECT SUM(QTDE) QUANTIDADE
      FROM REDEX.TB_BOOKING_CARGA
      WHERE AUTONUM_BOO = A.AUTONUM_BOO
      AND FLAG_CS       = 0
      )
  END,0) VOLUMES,
  G.DESCRICAO     AS ARMADOR,
  F.DESCRICAO_NAV AS NAVIO,
  D.RAZAO         AS EXPORTADOR,
  E.RAZAO         AS NVOCC,
  A.AUTONUM_VIA,
  B.NUM_VIAGEM,
  H.DESCRICAO_POR AS PORTO_ORIGEM,
  I.DESCRICAO_POR AS PORTO_DESTINO,
  B.DT_DEAD_LINE,
  B.AUTONUM_VIA AS AUTONUM_VIAGEM,
  A.AUTONUM_PATIOS AS PATIO
FROM REDEX.TB_BOOKING A
LEFT JOIN REDEX.TB_VIAGENS B
ON A.AUTONUM_VIA = B.AUTONUM_VIA
LEFT JOIN REDEX.TB_BOOKING_CARGA C
ON A.AUTONUM_BOO = C.AUTONUM_BOO
LEFT JOIN REDEX.TB_CAD_PARCEIROS D
ON A.AUTONUM_EXPORTADOR = D.AUTONUM
LEFT JOIN REDEX.TB_CAD_PARCEIROS E
ON A.AUTONUM_PARCEIRO = E.AUTONUM
LEFT JOIN REDEX.TB_CAD_NAVIOS F
ON B.AUTONUM_NAV = F.AUTONUM_NAV
LEFT JOIN REDEX.TB_CAD_ARMADOR G
ON A.AUTONUM_ARM = G.AUTONUM_ARM
LEFT JOIN REDEX.TB_CAD_PORTOS H
ON A.AUTONUM_FDES = H.AUTONUM_POR
LEFT JOIN REDEX.TB_CAD_PORTOS I
ON A.AUTONUM_POD  = I.AUTONUM_POR;
 

   
  CREATE OR REPLACE  VIEW REDEX.VW_AGENDAMENTO_WEB_ENTRADA_CS (TIPO, DATA, VEICULOS, QTDE, PESO, VOLUME) AS 
  SELECT 'ECS'                                 AS TIPO,
  TO_CHAR(T.INICIO,'DD/MM/YYYY')             AS DATA,
  COUNT(DISTINCT T.AUTONUM_TALIE)            AS VEICULOS,
  SUM(TI.QTDE_DESCARGA)                      AS QTDE,
  SUM(TI.PESO)                               AS PESO,
  SUM((TI.COMPRIMENTO*TI.LARGURA*TI.ALTURA)) AS VOLUME
FROM TB_TALIE T
INNER JOIN TB_TALIE_ITEM TI
ON T.AUTONUM_TALIE=TI.AUTONUM_TALIE
GROUP BY TO_CHAR(T.INICIO,'DD/MM/YYYY');
  
  CREATE OR REPLACE  VIEW REDEX.VW_AGENDAMENTO_WEB_SAIDA_CN (TIPO, DATA, VEICULOS, CNTRS) AS 
  SELECT 'SC'                            AS TIPO,
  TO_CHAR(GN.DT_GATE_OUT,'DD/MM/YYYY') AS DATA,
  COUNT(DISTINCT GN.AUTONUM)           AS VEICULOS,
  COUNT(1)                             AS CNTRS
FROM TB_AMR_GATE AMR
INNER JOIN TB_GATE_NEW GN
ON AMR.GATE                 =GN.AUTONUM
WHERE GN.FUNCAO_GATE_SAIDA IN (204,207)
GROUP BY TO_CHAR(GN.DT_GATE_OUT,'DD/MM/YYYY'); 
 
  CREATE OR REPLACE  VIEW REDEX.VW_AGENDAMENTO_WEB_SAIDA_CS (TIPO, DATA, VEICULOS, QTDE, PESO, VOLUME) AS 
  select 'SCS' as tipo, to_char(gn.dt_gate_out,'dd/mm/yyyy') as data, count(distinct gn.autonum) as veiculos
, sum(pcs.qtde_entrada) as qtde, sum(pcs.bruto) as peso, sum((pcs.comprimento*pcs.largura*pcs.altura)) as volume
from tb_amr_gate amr
inner join tb_gate_new gn on amr.gate=gn.autonum
inner join tb_patio_cs pcs on amr.cs_rdx = pcs.autonum_pcs
where gn.funcao_gate_saida = 208
group by to_char(gn.dt_gate_out,'dd/mm/yyyy');
 

  CREATE OR REPLACE  VIEW REDEX.VW_AGENDAMENTO_WEB_ENTRADA_CN (TIPO, DATA, VEICULOS, CNTRS) AS 
  SELECT 'EC'                           AS TIPO,
  TO_CHAR(GN.DT_GATE_IN,'DD/MM/YYYY') AS DATA,
  COUNT(DISTINCT GN.AUTONUM)          AS VEICULOS,
  COUNT(1)                            AS CNTRS
FROM TB_AMR_GATE AMR
INNER JOIN TB_GATE_NEW GN
ON AMR.GATE                   =GN.AUTONUM
WHERE GN.FUNCAO_GATE_ENTRADA IN (205,206)
GROUP BY TO_CHAR(GN.DT_GATE_IN,'DD/MM/YYYY');
 
  CREATE OR REPLACE  VIEW REDEX.VW_AGENDAMENTO_WEB_ENTRADA_CS (TIPO, DATA, VEICULOS, QTDE, PESO, VOLUME) AS 
  SELECT 'ECS'                                 AS TIPO,
  TO_CHAR(T.INICIO,'DD/MM/YYYY')             AS DATA,
  COUNT(DISTINCT T.AUTONUM_TALIE)            AS VEICULOS,
  SUM(TI.QTDE_DESCARGA)                      AS QTDE,
  SUM(TI.PESO)                               AS PESO,
  SUM((TI.COMPRIMENTO*TI.LARGURA*TI.ALTURA)) AS VOLUME
FROM TB_TALIE T
INNER JOIN TB_TALIE_ITEM TI
ON T.AUTONUM_TALIE=TI.AUTONUM_TALIE
GROUP BY TO_CHAR(T.INICIO,'DD/MM/YYYY');
 
  CREATE OR REPLACE  VIEW REDEX.VW_AGENDAMENTO_WEB_SAIDA_CN (TIPO, DATA, VEICULOS, CNTRS) AS 
  SELECT 'SC'                            AS TIPO,
  TO_CHAR(GN.DT_GATE_OUT,'DD/MM/YYYY') AS DATA,
  COUNT(DISTINCT GN.AUTONUM)           AS VEICULOS,
  COUNT(1)                             AS CNTRS
FROM TB_AMR_GATE AMR
INNER JOIN TB_GATE_NEW GN
ON AMR.GATE                 =GN.AUTONUM
WHERE GN.FUNCAO_GATE_SAIDA IN (204,207)
GROUP BY TO_CHAR(GN.DT_GATE_OUT,'DD/MM/YYYY');
 
  CREATE OR REPLACE  VIEW REDEX.VW_AGENDAMENTO_WEB_SAIDA_CS (TIPO, DATA, VEICULOS, QTDE, PESO, VOLUME) AS 
  select 'SCS' as tipo, to_char(gn.dt_gate_out,'dd/mm/yyyy') as data, count(distinct gn.autonum) as veiculos
, sum(pcs.qtde_entrada) as qtde, sum(pcs.bruto) as peso, sum((pcs.comprimento*pcs.largura*pcs.altura)) as volume
from tb_amr_gate amr
inner join tb_gate_new gn on amr.gate=gn.autonum
inner join tb_patio_cs pcs on amr.cs_rdx = pcs.autonum_pcs
where gn.funcao_gate_saida = 208
group by to_char(gn.dt_gate_out,'dd/mm/yyyy');
 

  
INSERT
  INTO REDEX.TB_AGENDAMENTO_WEB_PERIODO_DES
    (
      CS_M3_1,
      CS_M3_2,
      CS_M3_3,
      CS_M3_4,
      CS_M3_5,
      CS_M3_6,
      CS_M3_7,
      CS_M3_8,
      CS_PE_1,
      CS_PE_2,
      CS_PE_3,
      CS_PE_4,
      CS_PE_5,
      CS_PE_6,
      CS_PE_7,
      CS_PE_8,
      CS_VO_1,
      CS_VO_2,
      CS_VO_3,
      CS_VO_4,
      CS_VO_5,
      CS_VO_6,
      CS_VO_7,
      CS_VO_8,
      CS_CA_1,
      CS_CA_2,
      CS_CA_3,
      CS_CA_4,
      CS_CA_5,
      CS_CA_6,
      CS_CA_7,
      CS_CA_8,
      CN_CA_1,
      CN_CA_2,
      CN_CA_3,
      CN_CA_4,
      CN_CA_5,
      CN_CA_6,
      CN_CA_7,
      CN_CA_8,      
      FLAG_CS_M3,
      FLAG_CS_PESO,
      FLAG_CS_VOLUME,
      FLAG_CS_CAMINHAO,
      FLAG_CN_CAMINHAO
    )
    VALUES
    (
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      0,
      0,
      0,
      0,
      0
    );
  INSERT
  INTO REDEX.TB_AGENDAMENTO_WEB_PERIODO_CA
    (
      CS_M3_1,
      CS_M3_2,
      CS_M3_3,
      CS_M3_4,
      CS_M3_5,
      CS_M3_6,
      CS_M3_7,
      CS_M3_8,
      CS_PE_1,
      CS_PE_2,
      CS_PE_3,
      CS_PE_4,
      CS_PE_5,
      CS_PE_6,
      CS_PE_7,
      CS_PE_8,
      CS_VO_1,
      CS_VO_2,
      CS_VO_3,
      CS_VO_4,
      CS_VO_5,
      CS_VO_6,
      CS_VO_7,
      CS_VO_8,
      CS_CA_1,
      CS_CA_2,
      CS_CA_3,
      CS_CA_4,
      CS_CA_5,
      CS_CA_6,
      CS_CA_7,
      CS_CA_8,
      CN_CA_1,
      CN_CA_2,
      CN_CA_3,
      CN_CA_4,
      CN_CA_5,
      CN_CA_6,
      CN_CA_7,
      CN_CA_8,
      FLAG_CS_M3,
      FLAG_CS_PESO,
      FLAG_CS_VOLUME,
      FLAG_CS_CAMINHAO,
      FLAG_CN_CAMINHAO
    )
    VALUES
    (
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      '0',
      0,
      0,
      0,
      0,
      0
    );



INSERT
  INTO redex.tb_parametros_gpd_servicos
    (
      autonum,
      descr,
      servico_gate
    )
    VALUES
    (
      1,
      'CARGA SOLTA DESCARGA',
      'A'
    );
  INSERT
  INTO redex.tb_parametros_gpd_servicos
    (
      autonum,
      descr,
      servico_gate
    )
    VALUES
    (
      2,
      'CARGA SOLTA CARREGAMENTO',
      'B'
    );
INSERT
  INTO redex.tb_parametros_gpd_servicos
    (
      autonum,
      descr,
      servico_gate
    )
    VALUES
    (
      3,
      'CONTÊINER DESCARGA',
      'C'
    );
  INSERT
  INTO redex.tb_parametros_gpd_servicos
    (
      autonum,
      descr,
      servico_gate
    )
    VALUES
    (
      4,
      'CONTÊINER CARREGAMENTO',
      'D'
    );
